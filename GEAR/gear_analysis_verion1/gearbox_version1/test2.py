


import paho.mqtt.client as mqtt  #import the client1
import time
from configparser import ConfigParser
import logging
import sys
from collections import deque
import logging.handlers as handlers
import pandas as pd
import numpy as np
import math 
from numpy import mean, sqrt, square, arange
GMFF=115
GMFF2=1000
GMFF3=1970

list_1=[4.579669976578771e-16, 0.7306975392769018, 1.954934665925015, 2.9826205345522014, 1.111109837335696, 3.3681844992383994, 2.5229705284325212, 2.2390998476516297, 2.250169234702761, 3.1370487159090343, 3.0295383797025583, 2.8665571621647943, 2.4361491343170227, 5.807671021987568, 2.2332947996393986, 2.9322018910571543, 3.008965142394435, 3.6743417238445493, 4.548728735687286, 4.372198636947418, 1.5995459411554338, 2.0797884737600327, 5.120190138361808, 2.851200250696487, 2.040338546467552, 3.153040222327909, 4.407915137, 1.6201448954385165, 3.87583356564313, 0.8886462319695121, 2.9979372418256727, 2.2073075597287346, 5.125357249056396, 4.215331580295904, 4.727734002277868, 2.224794789199938, 1.7653947628882023, 2.9582907818201836, 0.6461888303684546, 5.095218046137773, 2.737929508630808, 3.534572679883606, 0.35474030560761066, 3.707107144292097, 4.69222533077728, 0.2634922563961597, 3.8267458721783165, 6.7083370646882186, 2.2045791827735406, 4.827277990138215, 1.4455105598791542, 6.6467112645726285, 2.0952945504758915, 2.0090204423821185, 2.2236305076558467, 3.310249682509711, 1.313380048119976, 3.1796046690340964, 2.4224454941637417, 2.171541558194035, 2.507653369555589, 4.175853872302032, 2.996535630132817, 1.9062259714940049, 2.086351544342665, 0.8761914036604075, 2.914742989839963, 2.1874639861608167, 3.3029116589667, 2.905408744948007, 1.8566321930826652, 2.9767130235705364, 2.627445087414741, 2.264955454669047, 3.0619676014870163, 2.0238486431274683, 2.8898107342369093, 3.5777787212823586, 1.763143730776983, 2.284993211912158, 3.715581182213972, 3.427211716772011, 2.661404996151696, 3.457647290033789, 2.199929125983804, 1.587789054840583, 4.817545801161818, 1.5376152751664065, 4.6486759155415855, 2.6189700847975805, 3.1315595277532644, 1.301146720881541, 1.2983138090033914, 2.3293070083186853, 4.4665196281542014, 3.008744737120108, 1.3496427121308816, 3.633487036779216, 2.366827154490183, 1.585166629363962, 8.868651865271767, 4.8958195924083725, 1.9297593404253268, 6.3718496043244475, 0.7544803169253118, 3.477268024402802, 2.7415845179530716, 3.452966243488671, 2.6916343722393865, 1.1434526657917048, 1.1690258052418705, 0.932706034053657, 1.9369198316689167, 2.640362887858627, 3.0171450450912896, 2.24089722484627, 6.138043930567625, 1.1366469356048152, 2.0825883920789487, 2.609111094170244, 1.4058448734589981, 2.311453329385575, 3.1477603124273914, 1.5877406510067456, 2.503824186635563, 1.4259450026308693, 1.6381017178381474, 2.063661187959958, 2.0134777574331015, 2.622516178728325, 2.5166086459386072, 1.844432228523405, 1.5538002712061945, 2.6273449541429414, 2.3480867228552684, 2.0092254282073916, 2.0958798636361853, 1.6117794562703869, 2.3836222620356944, 2.0235547125370315, 0.30627993170866424, 0.6233123920932461, 2.445596363133897, 1.5582880486809358, 3.8773929449698383, 1.663477331371711, 2.720705944802185, 1.8213014843782949, 1.6961200731941608, 0.5879404646361687, 2.94849920171803, 1.0856639763604365, 1.2767740126232199, 0.6282280759048438, 3.4904569382955466, 0.8834603172628872, 2.4184288472937, 1.0463828792757697, 4.942068024715741, 2.0931222133524803, 0.5565022869936739, 2.0610708034617793, 1.7843679812260713, 0.266550884148095, 4.083786387996953, 4.583183558652753, 4.354408716424132, 1.933980600529016, 2.861621784467048, 3.12281678190012, 2.0601884608428414, 3.062091714247568, 2.1510622886593533, 2.726584876482892, 2.0857693415587253, 4.435537797069783, 2.8881394502292337, 0.6144991910593091, 1.3406288441140897, 2.6747023823729115, 1.5151619930704558, 2.906405501118006, 2.3411355978522397, 1.7592481976643792, 2.55186700229012, 1.4305523583370814, 3.0619908496941974, 3.682089109254327, 1.1597218843964108, 1.3457029127874869, 0.46693504977243716, 1.6281536892134045, 3.128084364102692, 4.360391921814227, 2.5965194136754097, 2.2787930756233368, 5.1358663580765, 7.081660537785485, 7.9815387401306115, 6.383354288994416, 1.1305464571398127, 0.9740830622794352, 4.191112952149098, 3.732215006114712, 1.8632675639307212, 5.6546078249341, 2.3147130386570964, 4.596873853303264, 3.6042410827266527, 4.543952070484901, 3.040494697831736, 1.3711004708508165, 2.179151166379216, 2.0904723781354644, 1.7376869629358351, 3.232161823678512, 1.0829761761053003, 0.6819065827754628, 0.6981642511517517, 1.0117405291634785, 1.9698070693870853, 4.483766852077581, 1.6671359088123503, 2.077877647122014, 1.2904200880191434, 1.190751117505549, 1.0988959374099985, 1.1816686691060987, 2.408486728331586, 0.2229257853978177, 3.2570823750100817, 1.5632952913735998, 1.9514818146181918, 4.005004316932872, 0.7903454879579129, 1.470245430041858, 3.208294455356182, 3.2912108994599727, 2.705918831286819, 0.3330710206264217, 1.7125482507239638, 1.4538595050631349, 4.246720799448651, 6.569021588681372, 2.629701541970035, 1.3440061275646922, 4.367989839239078, 2.8591721590271253, 3.427061512874769, 3.108179608677269, 3.16384342349224, 1.5497672014706552, 2.7408117509771484, 0.4426486658269888, 1.1339077630832615, 0.3718067938397885]
rms =sqrt(mean(square(list_1)))
print(rms)
count_freq_greater = len([i for i in list_1 if i > 1.2*rms]) ####count of values which are greater than 1.2 times the RMS
sorted_list=sorted([(x,i) for (i,x) in enumerate(list_1)], reverse=True )[:count_freq_greater]  ######correspondig frequency and amplitudes greater than 1.2xRMS 
data_list=pd.DataFrame(sorted_list,columns=['amplitude','Frequency'])

frqn_lst=data_list['Frequency']
new_list=[]
new_list.append(frqn_lst)
print(new_list)
for element in frqn_lst:
    if element in range(int(GMFF-8),int(GMFF+8)):
        print("their is fault 1st harmonic in gear")
        if element in range(int(GMFF2-8),int(GMFF2+8)):
            print("their is fault in 2nd harmonic of gear")
            if element in range(int(GMFF3-8),int(GMFF3+8)):
                print("their is fault in gear")
                            
        